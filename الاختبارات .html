<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ - Ù…Ù†ØµØ© Ø¨Ø·ÙˆØ·</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-cyan: #00f2fe;
            --dark-cyan: #083344;
            --bg-deep: #020617;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(34, 211, 238, 0.2);
        }

        body {
            background: radial-gradient(circle at top, #0f172a, var(--bg-deep));
            color: white;
            font-family: 'Tajawal', sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            align-items: center;
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ù…Ø§Ù† */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-deep); z-index: 9999;
            display: flex; justify-content: center; align-items: center;
            font-size: 20px; color: var(--primary-cyan);
        }

        header {
            width: 100%; padding: 15px 5%;
            background: rgba(8, 51, 68, 0.4);
            backdrop-filter: blur(10px);
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid var(--border);
            box-sizing: border-box;
        }

        .container { width: 90%; max-width: 750px; margin-top: 30px; margin-bottom: 50px; flex-grow: 1; }

        .glass-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 25px;
            padding: 35px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-container { width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 10px; margin-bottom: 20px; overflow: hidden; }
        #progress-fill { width: 0%; height: 100%; background: var(--primary-cyan); transition: 0.4s; box-shadow: 0 0 10px var(--primary-cyan); }

        .q-text { font-size: 22px; margin-bottom: 25px; line-height: 1.6; text-align: center; }

        .options-grid { display: grid; gap: 12px; }

        .option-btn {
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
            padding: 15px 20px;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            transition: 0.3s;
            text-align: right;
            font-family: 'Tajawal';
            font-size: 16px;
        }

        .option-btn:hover { background: rgba(0, 242, 254, 0.1); border-color: var(--primary-cyan); transform: scale(1.01); }
        .option-btn.selected { background: var(--primary-cyan); color: var(--dark-cyan); font-weight: bold; border-color: white; }

        .btn-confirm {
            width: 100%; margin-top: 25px; padding: 15px; border-radius: 12px; border: none;
            background: linear-gradient(90deg, var(--primary-cyan), #4facfe);
            color: var(--dark-cyan); font-weight: bold; cursor: pointer; font-size: 18px;
            transition: 0.3s;
        }

        .btn-confirm:hover { filter: brightness(1.2); box-shadow: 0 0 20px rgba(0, 242, 254, 0.4); }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        .score-box { font-size: 60px; color: var(--primary-cyan); margin: 20px 0; font-weight: bold; text-align: center; }
        .locked-badge { background: rgba(16, 185, 129, 0.2); color: #10b981; padding: 5px 15px; border-radius: 50px; font-size: 12px; display: inline-block; margin-bottom: 15px; }

        footer { padding: 20px; color: #64748b; font-size: 13px; text-align: center; }
    </style>
</head>
<body>

<div id="loader">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ù‡ÙˆÙŠØªÙƒ Ø§Ù„Ø±Ù‚Ù…ÙŠØ©... ğŸ”</div>

<header>
    <div style="font-weight: bold; color: var(--primary-cyan); font-size: 1.2rem;">ğŸš€ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù†ØµØ© Ø¨Ø·ÙˆØ·</div>
    <div id="user-display" style="font-size: 13px; opacity: 0.8;"></div>
</header>

<div class="container">
    <div id="quiz-screen" class="glass-card" style="display:none;">
        <div class="progress-container"><div id="progress-fill"></div></div>
        <div id="q-number" style="color: var(--primary-cyan); font-size: 14px; margin-bottom: 10px;">Ø³Ø¤Ø§Ù„ 1 Ù…Ù† 15</div>
        <div class="q-text" id="question-text">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„...</div>
        <div class="options-grid" id="options-container"></div>
        <button class="btn-confirm" id="next-btn">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙˆØ§Ù„ØªØ­Ø±Ùƒ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>

    <div id="result-screen" class="glass-card" style="display:none; text-align: center;">
        <span class="locked-badge">ğŸ›¡ï¸ ØªÙ… Ù‚ÙÙ„ Ø§Ù„Ø¯Ø±Ø¬Ø© ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ù„Ù„Ù…Ø´Ø±Ù</span>
        <h2>Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h2>
        <div class="score-box" id="final-score">0%</div>
        <p style="color: #94a3b8; margin-bottom: 25px;">Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø£Ùˆ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯Ø±Ø¬Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.</p>
        <button class="btn-confirm" onclick="location.href='dashboard.html'">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
    </div>
</div>

<footer>
    ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ¨Ø±Ù…Ø¬Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨ÙˆØ§Ø³Ø·Ø© <b>MOHAMED AMR</b> | 2026 Â©
</footer>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDTWkD6ff9rYYc4T7yXaSP1hHLiGSNwSzk",
        authDomain: "blog-62e33.firebaseapp.com",
        projectId: "blog-62e33",
        storageBucket: "blog-62e33.firebasestorage.app",
        messagingSenderId: "804628373288",
        appId: "1:804628373288:web:b29db5c1600b5792393a1d"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (15 Ø³Ø¤Ø§Ù„Ø§Ù‹)
    const questions = [
        { q: "Ù…Ø§ Ù‡ÙŠ Ù„ØºØ© Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªÙŠ ØªÙØ³ØªØ®Ø¯Ù… Ù„ØªØµÙ…ÙŠÙ… Ù‡ÙŠÙƒÙ„ ØµÙØ­Ø§Øª Ø§Ù„ÙˆÙŠØ¨ØŸ", opts: ["HTML", "Python", "CSS", "SQL"], ans: 0 },
        { q: "Ø£ÙŠ Ù…Ù† Ø§Ù„Ù„ØºØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© ØªÙØ³ØªØ®Ø¯Ù… Ù„Ø¥Ø¶Ø§ÙØ© ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¬Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ù…ÙˆÙ‚Ø¹ØŸ", opts: ["PHP", "CSS", "C#", "HTML"], ans: 1 },
        { q: "Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ù„Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªÙ†Ø¨ÙŠÙ‡ ÙÙŠ JavaScriptØŸ", opts: ["msg()", "prompt()", "alert()", "confirm()"], ans: 2 },
        { q: "Ù…Ø§ Ù‡Ùˆ Ù†Ø§ØªØ¬ Ø¹Ù…Ù„ÙŠØ© 10 * 10ØŸ", opts: ["10", "100", "1000", "20"], ans: 1 },
        { q: "Ø£ÙŠ ÙƒÙˆÙƒØ¨ Ù‡Ùˆ Ø§Ù„Ø£Ù‚Ø±Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø´Ù…Ø³ØŸ", opts: ["Ø§Ù„Ù…Ø±ÙŠØ®", "Ø¹Ø·Ø§Ø±Ø¯", "Ø§Ù„Ø²Ù‡Ø±Ø©", "Ø§Ù„Ù…Ø´ØªØ±ÙŠ"], ans: 1 },
        { q: "Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± Ø­ÙŠÙˆØ§Ù† ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", opts: ["Ø§Ù„ÙÙŠÙ„", "Ø§Ù„Ø­ÙˆØª Ø§Ù„Ø£Ø²Ø±Ù‚", "Ø§Ù„Ø²Ø±Ø§ÙØ©", "Ø§Ù„Ù‚Ø±Ø´"], ans: 1 },
        { q: "ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø¶Ù„Ø§Ø¹ Ø§Ù„Ù…Ø«Ù„Ø«ØŸ", opts: ["2", "3", "4", "5"], ans: 1 },
        { q: "Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŸ", opts: ["Ø¬Ø¯Ø©", "Ù…ÙƒØ©", "Ø§Ù„Ø±ÙŠØ§Ø¶", "Ø§Ù„Ø¯Ù…Ø§Ù…"], ans: 2 },
        { q: "Ø£ÙŠ Ù„ØºØ© Ø¨Ø±Ù…Ø¬ÙŠØ© ØªÙØ³ØªØ®Ø¯Ù… Ø¨ÙƒØ«Ø±Ø© ÙÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠØŸ", opts: ["Java", "Python", "C++", "JavaScript"], ans: 1 },
        { q: "Ù…Ø§ Ù‡ÙŠ Ø³Ø±Ø¹Ø© Ø§Ù„Ø¶ÙˆØ¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠØ©ØŸ", opts: ["300 Ø£Ù„Ù ÙƒÙ…/Ø«", "150 Ø£Ù„Ù ÙƒÙ…/Ø«", "500 Ø£Ù„Ù ÙƒÙ…/Ø«", "100 Ø£Ù„Ù ÙƒÙ…/Ø«"], ans: 0 },
        { q: "Ù…Ù† Ù‡Ùˆ Ù…Ø¤Ø³Ø³ Ø´Ø±ÙƒØ© Ù…Ø§ÙŠÙƒØ±ÙˆØ³ÙˆÙØªØŸ", opts: ["Ø³ØªÙŠÙ Ø¬ÙˆØ¨Ø²", "Ø¨ÙŠÙ„ ØºÙŠØªØ³", "Ù…Ø§Ø±Ùƒ Ø²ÙˆÙƒØ±Ø¨ÙŠØ±Øº", "Ø¥ÙŠÙ„ÙˆÙ† Ù…Ø§Ø³Ùƒ"], ans: 1 },
        { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ Ø§Ù„Ø°ÙŠ Ø±Ù…Ø²Ù‡ OØŸ", opts: ["Ø§Ù„Ø°Ù‡Ø¨", "Ø§Ù„Ø­Ø¯ÙŠØ¯", "Ø§Ù„Ø£ÙƒØ³Ø¬ÙŠÙ†", "Ø§Ù„Ù‡ÙŠØ¯Ø±ÙˆØ¬ÙŠÙ†"], ans: 2 },
        { q: "ÙƒÙ… Ø¯Ù‚ÙŠÙ‚Ø© ÙÙŠ Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø©ØŸ", opts: ["50", "60", "70", "100"], ans: 1 },
        { q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ø°ÙŠ ÙŠØ­Ø¯ Ø§Ù„ÙˆØ·Ù† Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ù…Ù† Ø§Ù„ØºØ±Ø¨ØŸ", opts: ["Ø§Ù„Ù‡Ù†Ø¯ÙŠ", "Ø§Ù„Ù‡Ø§Ø¯ÙŠ", "Ø§Ù„Ø£Ø·Ù„Ø³ÙŠ", "Ø§Ù„Ù…ØªØ¬Ù…Ø¯"], ans: 2 },
        { q: "Ù‡Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù†ØµØ© Ø±Ø§Ø¦Ø¹Ø©ØŸ", opts: ["Ù†Ø¹Ù… Ø¬Ø¯Ø§Ù‹", "Ø¨Ø§Ù„ØªØ£ÙƒÙŠØ¯", "Ø§Ù„Ø£ÙØ¶Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚", "ÙƒÙ„ Ù…Ø§ Ø³Ø¨Ù‚"], ans: 3 }
    ];

    let currentUser = null;
    let currentQ = 0;
    let score = 0;
    let selected = null;

    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ø´ÙƒÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    onAuthStateChanged(auth, (user) => {
        if (user) {
            currentUser = user;
            document.getElementById('loader').style.display = 'none';
            document.getElementById('quiz-screen').style.display = 'block';
            document.getElementById('user-display').innerText = `Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${user.displayName || user.email}`;
            loadQuestion();
        } else {
            // Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø³ÙŠØ· Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„
            setTimeout(() => {
                if(!auth.currentUser) window.location.href = 'index.html';
            }, 2500);
        }
    });

    function loadQuestion() {
        const q = questions[currentQ];
        document.getElementById('question-text').innerText = q.q;
        document.getElementById('q-number').innerText = `Ø³Ø¤Ø§Ù„ ${currentQ + 1} Ù…Ù† ${questions.length}`;
        
        const progress = ((currentQ + 1) / questions.length) * 100;
        document.getElementById('progress-fill').style.width = progress + "%";

        const container = document.getElementById('options-container');
        container.innerHTML = '';
        selected = null;

        q.opts.forEach((opt, i) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt;
            btn.onclick = () => {
                selected = i;
                document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
            };
            container.appendChild(btn);
        });
    }

    document.getElementById('next-btn').onclick = async () => {
        if (selected === null) {
            alert("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¬Ø§Ø¨Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„!");
            return;
        }

        if (selected === questions[currentQ].ans) score++;
        
        currentQ++;
        if (currentQ < questions.length) {
            loadQuestion();
        } else {
            finalizeQuiz();
        }
    };

    async function finalizeQuiz() {
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';
        
        const finalPct = Math.round((score / questions.length) * 100);
        document.getElementById('final-score').innerText = finalPct + "%";

        // Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙˆÙ‚ÙÙ„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ ÙÙŠ Firestore
        try {
            await setDoc(doc(db, "exam_results", currentUser.uid), {
                student: currentUser.displayName || currentUser.email,
                final_score: finalPct,
                correct_count: score,
                is_locked: true,
                submitted_at: serverTimestamp()
            });
        } catch (error) {
            console.error("Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", error);
        }
    }
</script>
</body>
</html>